(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{92:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(25),s=n.n(c),i=n(21),o=n(2),l=n(5),u=n.n(l),d=n(14),m=n(4),j="/",b=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(j,"api/search/game"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:if("fail"!==(r=e.sent).result){e.next=8;break}return e.abrupt("return",{gameExists:!1,online:0});case 8:if("success"!==r.result){e.next=10;break}return e.abrupt("return",{gameExists:!0,online:r.online});case 10:return e.abrupt("return",{gameExists:!1,online:0});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=n(50),f=Object(x.io)("".concat("/","game"),{withCredentials:!0}),h=n(22),p=n(16),O={position:"bottom-center",hideProgressBar:!0,draggable:!1,autoClose:2e3,pauseOnHover:!1,closeOnClick:!0,transition:p.a,bodyClassName:"flex items-center flex-row  text-black rounded-lg"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occured";return Object(p.c)(e,Object(h.a)(Object(h.a)({},O),{},{type:"error",bodyClassName:"flex items-center flex-row  text-white rounded-lg"}))},v=function(e){return Object(p.c)(e,Object(h.a)(Object(h.a)({},O),{},{transition:p.a}))},w=n(1),y=function(e){var t=e.move;return Object(w.jsxs)("button",{className:"focus:outline-none text-5xl md:text-8xl",title:t,children:["Stone"===t&&"\u270a\ufe0f","Paper"===t&&"\ud83d\udd90\ufe0f","Scissor"===t&&"\u270c\ufe0f","Thinking"===t&&"\ud83e\udd14\ufe0f","Unknown"===t&&"\u2753\ufe0f"]})},k=function(e){var t=e.mode,n=e.gameId,a=Object(r.useState)(0),c=Object(m.a)(a,2),s=c[0],i=c[1],l=Object(r.useState)(0),b=Object(m.a)(l,2),x=b[0],h=b[1],p=Object(r.useState)("Thinking"),O=Object(m.a)(p,2),k=O[0],S=O[1],T=Object(r.useRef)(s),C=Object(r.useRef)(x),G=Object(r.useState)("Thinking"),E=Object(m.a)(G,2),I=E[0],M=E[1],J=Object(r.useRef)(k),P=Object(r.useRef)(I),R=Object(r.useState)("Thinking"),Y=Object(m.a)(R,2),_=Y[0],X=Y[1],D=Object(r.useState)(null),A=Object(m.a)(D,2),H=A[0],W=A[1],B=Object(r.useState)(null),U=Object(m.a)(B,2),F=U[0],L=U[1],q=Object(r.useState)(!1),z=Object(m.a)(q,2),K=z[0],Q=z[1],V="CREATE"===t?"X":"Y",Z=Object(o.f)(),$=function(){S("Thinking"),X("Thinking"),Q(!1),M("Thinking"),L(null),W(null),v("Game Restarted !")};Object(r.useEffect)((function(){J.current=k,P.current=I,T.current=s,C.current=x})),Object(r.useEffect)((function(){return ee(),f.on("moved",te),f.on("restarted",$),function(){f.off("moved",te),f.off("restarted",$)}}),[]);var ee=function(){var e=Object(d.a)(u.a.mark((function e(){var t,r,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(j,"api/fetch/game"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:n})});case 2:return t=e.sent,e.next=5,t.json();case 5:"success"===(r=e.sent).result?("X"===V?(S(r.xMove),"Thinking"!==r.yMove&&("Thinking"!==r.xMove?(M(r.yMove),Q(!0),(null===(a=N(r.xMove,r.yMove))||void 0===a?void 0:a.winner)&&(L("Winner: "+a.winner),W(a.winner)),(null===a||void 0===a?void 0:a.gameTied)&&L("Game tied")):X(r.yMove))):(S(r.yMove),"Thinking"!==r.xMove&&("Thinking"!==r.yMove?(M(r.xMove),Q(!0),(null===(c=N(r.xMove,r.yMove))||void 0===c?void 0:c.winner)&&(L("Winner: "+c.winner),W(c.winner)),(null===c||void 0===c?void 0:c.gameTied)&&L("Game tied")):X(r.xMove))),i(r.xScore),h(r.yScore)):"fail"===r.result&&(g("Game doesn't exist"),Z.replace({pathname:"/"}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(e){if("Thinking"!==J.current){if(e.player!==V){M(e.move);var t=N(J.current,e.move);if(t){var n;if(Q(!0),t.gameTied&&(L("Game Tied"),v("Game Tied")),t.winner)L("Winner: "+t.winner),W(t.winner),t.winner===J.current?(n=V,v("You won \ud83c\udf89\ufe0f")):(n="X"===V?"Y":"X",v("You lost")),"X"===n?i(T.current+1):"Y"===n&&h(C.current+1);(null===t||void 0===t?void 0:t.gameTied)&&L("Game tied")}}}else"Thinking"===J.current&&e.player!==V&&(M("Unknown"),X(e.move))};return Object(w.jsxs)("div",{className:"flex flex-col w-screen  items-center",children:[Object(w.jsxs)("div",{className:"text-center flex flex-col items-center ",children:[Object(w.jsx)("h1",{children:"Score"}),Object(w.jsxs)("p",{className:"text-sm text-gray-800 md:text-base",children:["You: ","CREATE"===t?s:x," | Opponent:"," ","CREATE"===t?x:s]})]}),Object(w.jsxs)("div",{className:"flex justify-evenly items-center flex-row mt-12 mb-12 w-full",children:[Object(w.jsx)("div",{className:"\n\t\t\t\t\tflex items-center justify-center rounded-full w-24 h-24 md:w-48 md:h-48 \n\t\t\t\t\t".concat(k===H?"bg-green-50":"bg-transparent"),children:Object(w.jsx)(y,{move:k})}),Object(w.jsx)("span",{className:"text-sm md:text-xl text-gray-500",children:"vs"}),Object(w.jsx)("div",{className:"\n\t\t\t\t\tflex items-center justify-center rounded-full w-24 h-24 md:w-48 md:h-48 \n\t\t\t\t\t".concat(I===H?"bg-green-50":"bg-transparent"),children:Object(w.jsx)(y,{move:I})})]}),Object(w.jsx)("div",{className:"flex justify-evenly flex-row  w-full",children:["Stone","Paper","Scissor"].map((function(e){return Object(w.jsx)("div",{className:"transition ".concat("Thinking"===k?"hover:bg-gray-50":""," flex items-center justify-center rounded-full w-20 h-20 md:w-40 md:h-40 ").concat(k===e?"bg-gray-100":"bg-transparent","\n\t\t\t\t\t\t"),onClick:function(){return function(e){if("Thinking"===k){if(S(e),"Thinking"!==_){M(_);var t,r=N(e,_);M(_),r&&(r.gameTied&&(L("Game Tied"),v("Game Tied")),Q(!0),r.winner&&(L("Winner: "+r.winner),W(r.winner),r.winner===e?(t=V,v("You won \ud83c\udf89\ufe0f")):(t="X"===V?"Y":"X",v("You lost")),"X"===t?i(T.current+1):"Y"===t&&h(C.current+1),f.emit("winner",{game_id:n,winner:t})))}f.emit("move",{move:e,game_id:n,player:V})}}(e)},children:Object(w.jsx)(y,{move:e})},e)}))}),Object(w.jsx)("p",{className:"mt-16 text-gray-500 text-sm md:text-base",children:F}),K&&Object(w.jsx)("button",{className:"mt-8 mb-4 px-4 py-3 bg-white border border-black rounded hover:text-white hover:bg-black transition",onClick:function(){return f.emit("restartGame",{game_id:n})},children:"Restart"})]})};function N(e,t){var n=[[["Stone","Paper"],"Paper"],[["Paper","Scissor"],"Scissor"],[["Stone","Scissor"],"Stone"]];if(e===t)return{winner:null,gameTied:!0};for(var r=0;r<n.length;r++)if(n[r][0].includes(e)&&n[r][0].includes(t))return{winner:n[r][1],gameTied:!1};return null}var S=function(){var e,t,n=Object(r.useState)(0),a=Object(m.a)(n,2),c=a[0],s=a[1],l=Object(o.g)(),j=Object(o.f)(),x=function(e){return s(e.online.length)},h=null===(e=l.state)||void 0===e?void 0:e.gameId,p=(null===(t=l.state)||void 0===t?void 0:t.mode)||"JOIN",O=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(h.toString());case 2:e.sent||(g("Game doesn't exist"),j.replace({pathname:"/"}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){void 0!==l.state&&h&&O()}),[]),Object(r.useEffect)((function(){return void 0!==l.state&&h&&f.emit("join",{game_id:h,player:"CREATE"===p?"X":"O"}),f.on("connected",x),f.on("disconnected",x),function(){f.emit("leave",{game_id:h,player:"CREATE"===p?"X":"O"}),f.off("connected",x),f.off("disconnected",x)}}),[]),l.state&&h||j.replace({pathname:"/"}),Object(w.jsxs)("div",{className:"flex flex-col items-center px-4",style:{height:window.innerHeight},children:[Object(w.jsx)(i.b,{to:"/",className:"underline text-gray-500",children:"Go Home"}),Object(w.jsxs)("p",{className:"self-end md:text-lg",children:["Joined: ",c]}),Object(w.jsx)("div",{className:"flex-grow-1 h-full justify-center flex flex-col",children:Object(w.jsx)(k,{gameId:h,mode:p})}),Object(w.jsxs)("a",{target:"_blank",href:window.location.origin+"/join/"+h,className:"my-4 text-gray-500 text-sm md:text-base",rel:"noreferrer",children:["Game: ",h]})]})},T=function(){var e=Object(r.useState)(null),t=Object(m.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!0),s=Object(m.a)(c,2),i=s[0],l=s[1],x=Object(r.useState)(null),f=Object(m.a)(x,2),h=f[0],p=f[1],O=Object(r.useState)(!1),y=Object(m.a)(O,2),k=y[0],N=y[1],S=Object(r.useState)(!1),T=Object(m.a)(S,2),C=T[0],G=T[1],E=Object(r.useState)(!1),I=Object(m.a)(E,2),M=I[0],J=I[1],P=Object(r.useState)(!1),R=Object(m.a)(P,2),Y=R[0],_=R[1],X=Object(o.f)(),D=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return G(!1),J(!0),e.prev=2,e.next=5,fetch("".concat(j,"api/create/game"));case 5:return t=e.sent,e.next=8,t.json();case 8:"success"===(n=e.sent).result&&(a(n.game_id),J(!1)),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(2),console.error(e.t0),J(!1),g();case 17:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,_(!0),e.next=6,b(h);case 6:(t=e.sent)?(l(!0),_(!1),2!==t.online?X.push({pathname:"/game",state:{gameId:h,mode:"JOIN"}}):N(!0)):(N(!1),l(!1),_(!1)),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0),g(),_(!1);case 15:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:"flex flex-col w-screen items-center justify-center px-4",style:{height:window.innerHeight},children:[Object(w.jsxs)("div",{className:"flex-grow-1 flex flex-col space-y-4 h-full items-center justify-center",children:[Object(w.jsxs)("span",{className:"flex",children:[Object(w.jsx)("p",{className:"text-xl md:text-4xl font-bold mt-2",children:"Stone-Paper-Scissor"}),Object(w.jsx)("p",{className:"font-light text-sm md:text-xl",children:"Online"})]}),Object(w.jsx)("h3",{className:"text-xl text-center pt-4",children:"Get Started"}),Object(w.jsxs)("div",{className:"flex justify-center flex-wrap",children:[Object(w.jsx)("div",{className:"px-0 py-2 md:px-3 md:py-0",children:Object(w.jsx)("button",{className:"bg-black text-white px-4 py-3 hover:bg-white hover:text-black border border-black transition",onClick:D,children:M?"Creating...":"Create a new game"})}),Object(w.jsx)("div",{className:"px-0 py-2 md:px-3 md:py-0",children:Object(w.jsx)("button",{onClick:function(){return G(!C)},className:"border border-black bg-transparent text-black hover:bg-black hover:text-white px-4 py-3 transition",children:Y?"Joining...":"Join a game"})})]}),n&&Object(w.jsxs)("div",{className:"flex items-center flex-col text-center py-4 px-4",children:[Object(w.jsxs)("h4",{className:"text-lg font-semibold",children:["Game Created.",Object(w.jsx)("br",{}),"Game ID : ",n]}),Object(w.jsx)("p",{className:"text-sm md:text-base",children:"Ask the other player to enter this ID while Joining the game. Or use the link below (Tap to copy) :"}),Object(w.jsx)("button",{onClick:function(){return function(e){var t;null===(t=navigator.clipboard)||void 0===t||t.writeText(e),v("Copied")}(window.location+"join/"+n)},className:"my-4 text-gray-700",children:window.location+"join/"+n}),void 0!==navigator.share&&Object(w.jsx)("button",{className:"text-lg font-medium ",onClick:function(){return function(e){if(navigator.share)try{navigator.share({title:"Stone Paper Scissor Online",text:"You're invited to play Stone Paper Scissor Online",url:e})}catch(t){console.error(t)}else console.error("Sharing not supported")}(window.location+"join/"+n)},children:"Share"}),Object(w.jsx)("button",{className:"bg-black text-white transition hover:bg-white hover:text-black  w-full md:w-64 py-3 my-4 border border-black",onClick:function(){return X.push({pathname:"/game",state:{gameId:n,mode:"CREATE"}})},children:"Start Game"})]}),C&&Object(w.jsxs)("div",{className:"",children:[Object(w.jsxs)("div",{className:"flex flex-row space-x-4 justify-center",children:[Object(w.jsx)("input",{type:"text",name:"gameID",id:"gameID",className:"bg-gray-100 px-4 py-3 rounded-md w-48",placeholder:"Game ID",onChange:function(e){p(e.target.value)}}),Object(w.jsx)("button",{className:"text-white bg-black py-3 px-6",onClick:A,children:"Join"})]}),Object(w.jsxs)("div",{children:[k&&Object(w.jsx)("h3",{className:"my-4 text-red-700",children:"Both players have already joined."}),!i&&Object(w.jsx)("h3",{className:"my-4 text-red-700",children:"Game doesn't exist. Create one to start playing."})]})]})]}),Object(w.jsxs)("div",{className:" mb-4 text-center flex flex-col text-sm md:text-base",children:[Object(w.jsx)("a",{href:"https://github.com/NiketanG/stone-paper-scissor-online",target:"_blank",rel:"noreferrer",className:"underline text-gray-600",children:"Learn More"}),Object(w.jsxs)("p",{children:["Designed and Developed by"," ",Object(w.jsx)("a",{href:"http://bit.ly/nikketan",children:"Niketan Gulekar"})," \xa9",(new Date).getFullYear()]})]})]})},C=function(){var e=Object(o.h)(),t=Object(o.f)(),n=function(){var n=Object(d.a)(u.a.mark((function n(){var r,a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("".concat(j,"api/search/game"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:e.gameId})});case 2:return r=n.sent,n.next=5,r.json();case 5:"fail"===(a=n.sent).result&&(g("Game does'nt exist"),t.replace({pathname:"/"})),"success"===a.result&&t.replace({pathname:"/game",state:{gameId:e.gameId,mode:"JOIN"}});case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(r.useEffect)((function(){n()}),[]),Object(w.jsxs)("div",{className:"flex flex-col items-center justify-center h-screen ",children:[Object(w.jsx)("p",{className:"text-2xl md:text-4xl my-2",children:"Joining Game"}),Object(w.jsxs)("p",{className:"my-8",children:["Game ID: ",e.gameId]})]})},G=(n(92),n(93),function(){return Object(w.jsxs)(i.a,{children:[Object(w.jsxs)(o.c,{children:[Object(w.jsx)(o.a,{exact:!0,path:"/",component:T}),Object(w.jsx)(o.a,{path:"/game",component:S}),Object(w.jsx)(o.a,{path:"/join/:gameId",component:C})]}),Object(w.jsx)(p.b,{limit:3})]})});s.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(G,{})}),document.getElementById("root"))}},[[94,1,2]]]);
//# sourceMappingURL=main.685a7fd5.chunk.js.map